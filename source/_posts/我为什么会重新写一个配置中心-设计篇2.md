---
title: 我为什么会手撸一个配置中心-设计篇（二）
date: 2020-04-11 20:45:24
tags: 
    - Java
    - Redis
    - 配置中心
categories :
    - Technology
---

## 基础功能分析--配置管理&维护
上文我们分析了配置域管理相关的功能，这次我们要分析下配置中心的核心功能：配置更新。
我们将从几个角度分析配置更新功能：

* 客户端配置收集与本地维护
* 服务端配置管理
* 配置的热更新

#### 客户端配置收集与本地维护
首先我们来讨论下我们平时使用配置的场景，前面一篇我们提到过，通过spring的@Value我们可以本地的管理配置。除此以为我们也可以实现自身的配置管理机制，最常见的如数据库管理并加载、KV中间件存储并加载、本地文件存储并加载等。

考虑到项目本身希望更少的依赖第三方服务，同时能够实现配置的收集和管理，spring提供的@Valule不失为一个不错的选择。首先，spring容器会为我们自动收集并管理配置信息；其次，也提供了良好的环境配置隔离和本地配置维护。如果我们能够获取spring容器中维护的配置对象那不就能手工干预客户端配置的维护过程吗！

#### 服务端配置管理
相比客户端配置的管理，服务端就容易很多。通过上篇的分析，我们完全能够构建出自己的配置项结构，并交由DB持久化从而达到服务端配置管理的功能。

#### 配置的热更新
有了之前的客户端配置的收集和服务端配置管理的分析，我们要实现一套配置的热更新的技术方向就非常明确了。

首先，客户端启动的时候，我们需要从远程服务端拉取到最新的配置，如果拉取不到则使用本地默认的。

{% asset_img 客户端启动并更新配置.jpeg 600 600 客户端启动并更新配置 %}

其次，为了实现热更新。每当服务端对配置进行变更后，需要实时通知相应的客户端，并且客户端要同时更新最新的配置。

{% asset_img 服务端热更新配置.jpeg 600 600 服务端热更新配置 %}

## 其他
以上功能保证了我们的配置中心最基本的配置管理功能的整个生命周期。但围绕整个配置中心，还有许多其他功能需要分析，如配置的权限、用户的管理等。接下来的博客中，我们讲会讨论实现一个完整的配置中心，我们至少还需要哪些功能。最后围绕这些功能，我们会进入下一个重要篇章：选型篇。

先做一个预告，后面的更新我们会围绕以下几个功能去展开：
* 选型
* 功能实现与源码
* 与其他配置中心的比较
* 未来的优化与展望
